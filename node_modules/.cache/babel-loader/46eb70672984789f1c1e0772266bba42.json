{"remainingRequest":"E:\\shixun7_3\\frontend\\node_modules\\thread-loader\\dist\\cjs.js!E:\\shixun7_3\\frontend\\node_modules\\babel-loader\\lib\\index.js!E:\\shixun7_3\\frontend\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\shixun7_3\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\shixun7_3\\frontend\\src\\components\\common\\ExcelFileUpload.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\shixun7_3\\frontend\\src\\components\\common\\ExcelFileUpload.vue","mtime":1750921362000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\shixun7_3\\frontend\\babel.config.js","mtime":1751688362000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\shixun7_3\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuaXRlcmF0b3IuZm9yLWVhY2guanMiOwppbXBvcnQgc3RvcmFnZSBmcm9tICJAL3V0aWxzL3N0b3JhZ2UiOwppbXBvcnQgYmFzZSBmcm9tICJAL3V0aWxzL2Jhc2UiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIC8vIOafpeeci+Wkp+WbvgogICAgICBkaWFsb2dWaXNpYmxlOiBmYWxzZSwKICAgICAgLy8g5p+l55yL5aSn5Zu+CiAgICAgIGRpYWxvZ0ltYWdlVXJsOiAiIiwKICAgICAgLy8g57uE5Lu25riy5p+T5Zu+54mH55qE5pWw57uE5a2X5q6177yM5pyJ54m55q6K5qC85byP6KaB5rGCCiAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgZmlsZVVybExpc3Q6IFtdLAogICAgICBteUhlYWRlcnM6IHt9CiAgICB9OwogIH0sCiAgcHJvcHM6IFsidGlwIiwgImFjdGlvbiIsICJsaW1pdCIsICJtdWx0aXBsZSIsICJmaWxlVXJscyJdLAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmluaXQoKTsKICAgIHRoaXMubXlIZWFkZXJzID0gewogICAgICAnVG9rZW4nOiBzdG9yYWdlLmdldCgiVG9rZW4iKQogICAgfTsKICB9LAogIHdhdGNoOiB7CiAgICBmaWxlVXJsczogZnVuY3Rpb24gKHZhbCwgb2xkVmFsKSB7CiAgICAgIC8vICAgY29uc29sZS5sb2coIm5ldzogJXMsIG9sZDogJXMiLCB2YWwsIG9sZFZhbCk7CiAgICAgIHRoaXMuaW5pdCgpOwogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIOiuoeeul+WxnuaAp+eahCBnZXR0ZXIKICAgIGdldEFjdGlvblVybDogZnVuY3Rpb24gKCkgewogICAgICBjb25zb2xlLmxvZygxMjMpOwogICAgICB0aGlzLmZpbGVMaXN0ID0gW107CiAgICAgIC8vIHJldHVybiBiYXNlLnVybCArIHRoaXMuYWN0aW9uICsgIj90b2tlbj0iICsgc3RvcmFnZS5nZXQoInRva2VuIik7CiAgICAgIHJldHVybiBgLyR7dGhpcy4kYmFzZS5uYW1lfS9gICsgdGhpcy5hY3Rpb247CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyDliJ3lp4vljJYKICAgIGluaXQoKSB7CiAgICAgIC8vICAgY29uc29sZS5sb2codGhpcy5maWxlVXJscyk7CiAgICAgIGlmICh0aGlzLmZpbGVVcmxzKSB7CiAgICAgICAgdGhpcy5maWxlVXJsTGlzdCA9IHRoaXMuZmlsZVVybHMuc3BsaXQoIiwiKTsKICAgICAgICBsZXQgZmlsZUFycmF5ID0gW107CiAgICAgICAgdGhpcy5maWxlVXJsTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgICAgdmFyIHVybCA9IGl0ZW07CiAgICAgICAgICB2YXIgbmFtZSA9IGluZGV4OwogICAgICAgICAgdmFyIGZpbGUgPSB7CiAgICAgICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgICAgIHVybDogdXJsCiAgICAgICAgICB9OwogICAgICAgICAgZmlsZUFycmF5LnB1c2goZmlsZSk7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zZXRGaWxlTGlzdChmaWxlQXJyYXkpOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlQmVmb3JlVXBsb2FkKGZpbGUpIHt9LAogICAgLy8g5LiK5Lyg5paH5Lu25oiQ5Yqf5ZCO5omn6KGMCiAgICBoYW5kbGVVcGxvYWRTdWNjZXNzKHJlcywgZmlsZSwgZmlsZUxpc3QpIHsKICAgICAgaWYgKHJlcyAmJiByZXMuY29kZSA9PT0gMCkgewogICAgICAgIGZpbGVMaXN0W2ZpbGVMaXN0Lmxlbmd0aCAtIDFdWyJ1cmwiXSA9ICJ1cGxvYWQvIiArIGZpbGUucmVzcG9uc2UuZmlsZTsKICAgICAgICB0aGlzLnNldEZpbGVMaXN0KGZpbGVMaXN0KTsKICAgICAgICB0aGlzLiRlbWl0KCJjaGFuZ2UiLCB0aGlzLmZpbGVVcmxMaXN0LmpvaW4oIiwiKSk7CiAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCLmlofku7blr7zlhaXmiJDlip8iKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlcy5tc2cpOwogICAgICB9CiAgICB9LAogICAgLy8g5Zu+54mH5LiK5Lyg5aSx6LSlCiAgICBoYW5kbGVVcGxvYWRFcnIoZXJyLCBmaWxlLCBmaWxlTGlzdCkgewogICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLmlofku7blr7zlhaXlpLHotKUiKTsKICAgIH0sCiAgICAvLyDnp7vpmaTlm77niYcKICAgIGhhbmRsZVJlbW92ZShmaWxlLCBmaWxlTGlzdCkgewogICAgICB0aGlzLnNldEZpbGVMaXN0KGZpbGVMaXN0KTsKICAgICAgdGhpcy4kZW1pdCgiY2hhbmdlIiwgdGhpcy5maWxlVXJsTGlzdC5qb2luKCIsIikpOwogICAgfSwKICAgIC8vIOafpeeci+Wkp+WbvgogICAgaGFuZGxlVXBsb2FkUHJldmlldyhmaWxlKSB7CiAgICAgIHRoaXMuZGlhbG9nSW1hZ2VVcmwgPSBmaWxlLnVybDsKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZTsKICAgIH0sCiAgICAvLyDpmZDliLblm77niYfmlbDph48KICAgIGhhbmRsZUV4Y2VlZChmaWxlcywgZmlsZUxpc3QpIHsKICAgICAgdGhpcy4kbWVzc2FnZS53YXJuaW5nKGDmnIDlpJrkuIrkvKAke3RoaXMubGltaXR95byg5Zu+54mHYCk7CiAgICB9LAogICAgLy8g6YeN5paw5a+5ZmlsZUxpc3Tov5vooYzotYvlgLwKICAgIHNldEZpbGVMaXN0KGZpbGVMaXN0KSB7CiAgICAgIHZhciBmaWxlQXJyYXkgPSBbXTsKICAgICAgdmFyIGZpbGVVcmxBcnJheSA9IFtdOwogICAgICAvLyDmnInkupvlm77niYfkuI3mmK/lhazlvIDnmoTvvIzmiYDku6XpnIDopoHmkLrluKZ0b2tlbuS/oeaBr+WBmuadg+mZkOagoemqjAogICAgICB2YXIgdG9rZW4gPSBzdG9yYWdlLmdldCgidG9rZW4iKTsKICAgICAgbGV0IF90aGlzID0gdGhpczsKICAgICAgZmlsZUxpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICB2YXIgdXJsID0gaXRlbS51cmwuc3BsaXQoIj8iKVswXTsKICAgICAgICBpZiAoIXVybC5zdGFydHNXaXRoKCJodHRwIikpIHsKICAgICAgICAgIHVybCA9IF90aGlzLiRiYXNlLnVybCArIHVybDsKICAgICAgICB9CiAgICAgICAgdmFyIG5hbWUgPSBpdGVtLm5hbWU7CiAgICAgICAgdmFyIGZpbGUgPSB7CiAgICAgICAgICBuYW1lOiBuYW1lLAogICAgICAgICAgdXJsOiB1cmwgKyAiP3Rva2VuPSIgKyB0b2tlbgogICAgICAgIH07CiAgICAgICAgZmlsZUFycmF5LnB1c2goZmlsZSk7CiAgICAgICAgZmlsZVVybEFycmF5LnB1c2godXJsKTsKICAgICAgfSk7CiAgICAgIHRoaXMuZmlsZUxpc3QgPSBmaWxlQXJyYXk7CiAgICAgIHRoaXMuZmlsZVVybExpc3QgPSBmaWxlVXJsQXJyYXk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["storage","base","data","dialogVisible","dialogImageUrl","fileList","fileUrlList","myHeaders","props","mounted","init","get","watch","fileUrls","val","oldVal","computed","getActionUrl","console","log","$base","name","action","methods","split","fileArray","forEach","item","index","url","file","push","setFileList","handleBeforeUpload","handleUploadSuccess","res","code","length","response","$emit","join","$message","success","error","msg","handleUploadErr","err","handleRemove","handleUploadPreview","handleExceed","files","warning","limit","fileUrlArray","token","_this","startsWith"],"sources":["src/components/common/ExcelFileUpload.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 上传文件组件 -->\r\n    <el-upload\r\n      ref=\"upload\"\r\n      :action=\"getActionUrl\"\r\n      list-type=\"picture-card\"\r\n      accept=\".xls,.xlsx\"\r\n      :limit=\"limit\"\r\n      :headers=\"myHeaders\"\r\n      :on-exceed=\"handleExceed\"\r\n      :on-preview=\"handleUploadPreview\"\r\n      :on-remove=\"handleRemove\"\r\n      :on-success=\"handleUploadSuccess\"\r\n      :on-error=\"handleUploadErr\"\r\n      :before-upload=\"handleBeforeUpload\"\r\n      :show-file-list=\"false\"\r\n    >\r\n      <i class=\"el-icon-plus\"></i>\r\n      <div slot=\"tip\" class=\"el-upload__tip\" style=\"color:#838fa1;\">{{tip}}</div>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\" size=\"tiny\" append-to-body>\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport storage from \"@/utils/storage\";\r\nimport base from \"@/utils/base\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      // 查看大图\r\n      dialogVisible: false,\r\n      // 查看大图\r\n      dialogImageUrl: \"\",\r\n      // 组件渲染图片的数组字段，有特殊格式要求\r\n      fileList: [],\r\n      fileUrlList: [],\r\n      myHeaders:{}\r\n    };\r\n  },\r\n  props: [\"tip\", \"action\", \"limit\", \"multiple\", \"fileUrls\"],\r\n  mounted() {\r\n    this.init();\r\n    this.myHeaders= {\r\n      'Token':storage.get(\"Token\")\r\n    }\r\n  },\r\n  watch: {\r\n    fileUrls: function(val, oldVal) {\r\n      //   console.log(\"new: %s, old: %s\", val, oldVal);\r\n      this.init();\r\n    }\r\n  },\r\n  computed: {\r\n    // 计算属性的 getter\r\n    getActionUrl: function() {\r\n\t\tconsole.log(123)\r\n\t\tthis.fileList = []\r\n      // return base.url + this.action + \"?token=\" + storage.get(\"token\");\r\n      return `/${this.$base.name}/` + this.action;\r\n    }\r\n  },\r\n  methods: {\r\n    // 初始化\r\n    init() {\r\n      //   console.log(this.fileUrls);\r\n      if (this.fileUrls) {\r\n        this.fileUrlList = this.fileUrls.split(\",\");\r\n        let fileArray = [];\r\n        this.fileUrlList.forEach(function(item, index) {\r\n          var url = item;\r\n          var name = index;\r\n          var file = {\r\n            name: name,\r\n            url: url\r\n          };\r\n          fileArray.push(file);\r\n        });\r\n        this.setFileList(fileArray);\r\n      }\r\n    },\r\n    handleBeforeUpload(file) {\r\n    \r\n    },\r\n    // 上传文件成功后执行\r\n    handleUploadSuccess(res, file, fileList) {\r\n      if (res && res.code === 0) {\r\n        fileList[fileList.length - 1][\"url\"] = \"upload/\" + file.response.file;\r\n        this.setFileList(fileList);\r\n        this.$emit(\"change\", this.fileUrlList.join(\",\"));\r\n        this.$message.success(\"文件导入成功\");\r\n      } else {\r\n        this.$message.error(res.msg);\r\n      }\r\n    },\r\n    // 图片上传失败\r\n    handleUploadErr(err, file, fileList) {\r\n      this.$message.error(\"文件导入失败\");\r\n    },\r\n    // 移除图片\r\n    handleRemove(file, fileList) {\r\n      this.setFileList(fileList);\r\n      this.$emit(\"change\", this.fileUrlList.join(\",\"));\r\n    },\r\n    // 查看大图\r\n    handleUploadPreview(file) {\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    // 限制图片数量\r\n    handleExceed(files, fileList) {\r\n      this.$message.warning(`最多上传${this.limit}张图片`);\r\n    },\r\n    // 重新对fileList进行赋值\r\n    setFileList(fileList) {\r\n      var fileArray = [];\r\n      var fileUrlArray = [];\r\n      // 有些图片不是公开的，所以需要携带token信息做权限校验\r\n      var token = storage.get(\"token\");\r\n      let _this = this;\r\n      fileList.forEach(function(item, index) {\r\n        var url = item.url.split(\"?\")[0];\r\n    if(!url.startsWith(\"http\")) {\r\n      url = _this.$base.url+url\r\n    }\r\n        var name = item.name;\r\n        var file = {\r\n          name: name,\r\n          url: url + \"?token=\" + token\r\n        };\r\n        fileArray.push(file);\r\n        fileUrlArray.push(url);\r\n      });\r\n      this.fileList = fileArray;\r\n      this.fileUrlList = fileUrlArray;\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n</style>\r\n\r\n"],"mappings":"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","ignoreList":[]}]}